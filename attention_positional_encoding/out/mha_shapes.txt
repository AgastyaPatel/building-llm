Input x:  (1, 4, 12) = (B, T, d_model)
linear qkv: (1, 4, 36) = (B, T, 3 * d_model)
q,k,v split: q=(1, 4, 3, 4) k=(1, 4, 3, 4) v=(1, 4, 3, 4)
transposed heads: q=(1, 3, 4, 4) k=(1, 3, 4, 4) v=(1, 3, 4, 4)
scores: (1, 3, 4, 4) = (B, n_heads, T, T)
softmax(weights): (1, 3, 4, 4) = (B, n_heads, T, T)
context @v: (1, 3, 4, 4) = (B, n_heads, T, d_head)
merged heads: (1, 4, 12) = (B, T, d_model)
final projected out: (1, 4, 12) = (B, T, d_model)

legend:
 B=batch size
 T = sequence length
 d_model = embedding dimension
 n_heads = number of heads
 d_head = dimension of each head = d_model // n_heads
 d_model = n_heads * d_head
 q = query
 k = key
 v = value
 scores = qk^T
 qkv(x) is a single Linear producing [Q|K|V]; we reshape then split into q,k,v
